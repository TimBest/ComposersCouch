{% extends 'profile/artist/detail.html' %}
{% load i18n thumbnail %}


{% block musicClass %}active{% endblock %}
{% block dropdownTitle %}Music{% endblock %}

{% block panelBody %}
  <div class="music">
    <div class="row no-gutter page-header">
      <a class="{{isEditable}} btn btn-success" href="{{ url('artist:albumForm') }}">
        <span class="fa fa-plus"></span> Add Album
      </a>
      <div class="pull-right social-links">
        <a href="{{ url('artist:musicLinksForm') }}" class="{{isEditable}}">Edit<span class="hidden-xs"> Links</span></a>
        {% with music=artist_profile.music_links %}
          {% if music.bandcamp %}<a href="{{ music.bandcamp }}" target="_blank" class="btn btn-bandcamp">bc</a>{% endif %}
          {% if music.itunes %}<a href="{{ music.itunes }}" target="_blank" class="btn btn-itunes"><span class="fa fa-apple"></span></a>{% endif %}
          {% if music.spotify %}<a href="{{ music.spotify }}" target="_blank" class="btn btn-spotify"><span class="fa fa-spotify"></span></a>{% endif %}
          {% if music.soundcloud %}<a href="{{ music.soundcloud }}" target="_blank" class="btn btn-soundcloud"><span class="fa fa-soundcloud"></span></a>{% endif %}
        {% endwith %}
      </div>
    </div>
    {% for album in artist_profile.albums.all %}
      <div class="album">
        <div class="panel panel-default">
          <div class="panel-heading">
            <div class="row">
              <div class="col-sm-2">
                <h4>{{ album.title }} {% if album.year %}({{album.year}}){% endif %}</h4>
              </div>
              <div class="col-sm-10">
                <p>{{ album.description|linebreaks }}</p>
                <div>
                  Genres:
                  {% for genre in album.genre.all %}
                    {{genre}}
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
          <div class="panel-body">
            <div class="row no-gutter">
              <div class="col-sm-2 left">
                <div class="image-frame">
                  <span class="frame-helper"></span>
                  {% thumbnail album.album_art.image "120x120" as im %}
                    <img class="image-center" style="margin:{{ im|margin:'120x120' }}" width="{{im.x}}" height="{{im.y}}" alt="{{ album.title }} Album Art" src="{{media_url}}{{ im }}">
                  {% endthumbnail %}
                </div>
                {% include "tracks/_playlist_controls.html" with id=album.id %}
              </div>
              <div class="col-sm-10 right">
                {% include "tracks/_player.html" with id=album.id %}
              </div>
            </div>
            <div class="row no-gutter">
              <div class="col-sm-2 left">
                <a class="text-primary {{isEditable}}" href="{% url 'artist:editAlbumForm' album %}">
                  <span class="fa fa-pencil"> Edit Album</span>
                </a>
              </div>
              <div class="col-sm-10 right">
                <a class="text-primary {{isEditable}}" href="{% url 'artist:tracksForm' album %}">
                  <span class="fa fa-pencil"> Edit Tracks</span>
                </a>
              </div>
            </div>
          </div>
        </div>
        <div class="hidden">
          <div class="json_playlist" id="{{ album.id }}">
            {{ album.get_json_playlist }}
          </div>
        </div>
      </div>
    {% else %}
      <p>This artist has not added any music yet.</p>
    {% endfor %}
  </div>
{% endblock %}
